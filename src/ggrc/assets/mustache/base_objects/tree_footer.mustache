
{{#is_allowed_to_map parent_instance model.shortName}}
{{#if allow_mapping_or_creating}}
<li class="tree-footer tree-item tree-item-add">
  <div class="row-fluid">
    <div class="span12 section-expandable">

      {{#if model.root_object}}
      <a
        class="section-add"
        href="javascript://"
        rel="tooltip"
        data-placement="left"
        data-toggle="multitype-modal-selector"
        data-join-option-type="{{model.shortName}}"
        data-join-object-id="{{parent_instance.id}}"
        data-join-object-type="{{parent_instance.constructor.shortName}}"
        data-original-title="Map {{firstnonempty title_singular model.title_singular 'Object'}} to this {{firstnonempty parent_instance.constructor.title_singular 'Object'}}">
        + {{model.title_singular}}
      </a>
      {{#if null}}
      <span class="section-expander">
        <a href="javascript://" data-toggle="modal-ajax-form" data-modal-reset="reset" data-modal-class="modal-wide" data-object-singular="{{parent_instance.constructor.model_singular}}" data-object-plural="{{parent_instance.constructor.table_plural}}" >
          <i class="grcicon-add-black"></i>
          Create Object
        </a>
      </span>
      {{/if}}
      {{else}}
      <a
        class="section-add section-sticky"
        href="javascript://"
        rel="tooltip"
        data-placement="left"
        data-toggle="multitype-modal-selector"
        data-join-object-id="{{parent_instance.id}}"
        data-join-object-type="{{parent_instance.constructor.shortName}}"
        data-original-title="Map {{firstnonempty title_singular model.title_singular 'Object'}} to this {{firstnonempty parent_instance.constructor.title_singular 'Object'}}"
        data-object-params='{{#if_equals parent_instance.constructor.shortName "Section"}}{ "section": { "id": {{parent_instance.id}}, "title": "{{json_escape parent_instance.title}}", "description": "{{json_escape parent_instance.description}}" } }{{/if_equals}}'>
        + Object
      </a>
      {{#if_equals parent_instance.constructor.shortName "Section"}}
      <span class="section-expander">
        &nbsp;
        &nbsp;
        <a 
          href="javascript://" 
          data-toggle="modal-ajax-form" 
          data-modal-reset="reset" 
          data-dirty="#category_objectives, #combo" 
          data-route="category_objectives" 
          data-modal-class="modal-wide" 
          data-object-singular="Objective" 
          data-object-plural="objectives"
          data-object-params='{ "section": { "id": {{parent_instance.id}}, "title": "{{json_escape parent_instance.title}}" }, "description": "{{json_escape parent_instance.description}}" }'>
          + Objective
        </a>
      </span>
      {{/if_equals}}
      {{/if}}
    </div>
  </div>
</li>
{{/if}}
{{/is_allowed_to_map}}
