{{!
    Copyright (C) 2017 Google Inc.
    Licensed under http://www.apache.org/licenses/LICENSE-2.0 <see LICENSE file>
}}

<div class="tree-item-wrapper {{extraClasses}}">
  <div class="flex-box tree-item-content">
    <tree-item-actions {instance}="instance"
                       (expand)="onExpand()"
                       (preview)="onPreview(%event)"
                       {expanded}="expanded"
                       {child-models-list}="childModelsList"
                       {deep-limit}="limitDepthTree"
    ></tree-item-actions>
    <div class="flex-box selectable-attrs width-100" ($click)="select($element)">
        {{#selectedColumns}}
          <div class="flex-box attr-cell">
            {{#if_equals attr_type 'custom'}}
              <div class="custom attr-content">
                {{#get_custom_attr_value this instance}}
                {{! because the object can currently only be a
                    person there is no need to switch }}
                  {{#using person=object}}
                    {{>'/static/mustache/people/popover.mustache'}}
                  {{/using}}
                {{/get_custom_attr_value}}
              </div>
            {{else}}
              <div class="owner attr-content">
                {{#instance}}
                  {{#switch type}}
                    {{#case 'Audit'}}
                      {{> '/static/mustache/audits/tree-item-attr.mustache'}}
                    {{/case}}
                    {{#case 'Control'}}
                      {{> '/static/mustache/controls/tree-item-attr.mustache'}}
                    {{/case}}
                    {{#case 'Directive'}}
                      {{> '/static/mustache/directives/tree-item-attr.mustache'}}
                    {{/case}}
                    {{#case 'Objective'}}
                      {{> '/static/mustache/objectives/tree-item-attr.mustache'}}
                    {{/case}}
                    {{#case 'Person'}}
                      {{> '/static/mustache/people/tree-item-attr.mustache'}}
                    {{/case}}
                    {{#case 'Program'}}
                      {{> '/static/mustache/programs/tree-item-attr.mustache'}}
                    {{/case}}
                    {{#case 'Section'}}
                      {{> '/static/mustache/sections/tree-item-attr.mustache'}}
                    {{/case}}
                    {{#case 'RiskAssessment'}}
                      {{> '/static/mustache/risk_assessments/tree-item-attr.mustache'}}
                    {{/case}}
                    {{#case 'Workflow'}}
                      {{> '/static/mustache/workflows/tree-item-attr.mustache'}}
                    {{/case}}
                    {{#case 'CycleTaskGroupObjectTask'}}
                      {{> '/static/mustache/cycle_task_group_object_tasks/tree-item-attr.mustache'}}
                    {{/case}}
                    {{#case 'TaskGroup'}}
                      {{> '/static/mustache/task_groups/tree-item-attr.mustache'}}
                    {{/case}}
                    {{#default}}
                      {{> '/static/mustache/base_objects/tree-item-attr.mustache'}}
                    {{/default}}
                  {{/switch}}
                {{/instance}}
              </div>
            {{/if_equals}}
          </div>
        {{/selectedColumns}}
    </div>

    <cycle-task-actions {instance}="instance"></cycle-task-actions>

    <tree-item-extra-info {instance}="instance"></tree-item-extra-info>
  </div>

  <div class="sub-tier">
  <sub-tree-wrapper {parent}="instance"
                    {limit-depth-tree}="limitDepthTree"
                    {child-models}="selectedChildModels"
                    {get-depth-filter}="@getDepthFilter"
                    {is-open}="expanded"
  ></sub-tree-wrapper>
</div>
</div>
