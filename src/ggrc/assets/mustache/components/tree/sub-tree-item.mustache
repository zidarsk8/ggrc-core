{{!
    Copyright (C) 2017 Google Inc.
    Licensed under http://www.apache.org/licenses/LICENSE-2.0 <see LICENSE file>
}}

<div class="flex-box sub-item-content {{cssClasses}}">
  <tree-item-actions {instance}="instance"
                     (expand)="onExpand()"
                     (preview)="onPreview(%event)"
                     {expanded}="expanded"
                     {child-models-list}="childModelsList"
                     {deep-limit}="limitDepthTree"
  ></tree-item-actions>
  <div class="flex-box columns" ($click)="select($element)">
    <span class="title">
      <i class="fa fa-{{instance.class.table_singular}}"></i>
      {{title}}
    </span>

    {{#if_instance_of instance 'CycleTaskGroup|CycleTaskGroupObjectTask'}}
      {{#using status=instance.status}}
        <div class="flex-box state">
          <span class="state-value-dot {{addclass 'state-' status separator=''}}">
            {{status}}
          </span>
        </div>
      {{/using}}
    {{/if_instance_of}}
  </div>

  <cycle-task-actions {instance}="instance"
                      (expand)="onExpand(%event)"
  ></cycle-task-actions>

  <tree-item-extra-info {instance}="instance"></tree-item-extra-info>
</div>

<div class="sub-tier">
  <sub-tree-wrapper {parent}="instance"
                    {limit-depth-tree}="limitDepthTree"
                    {child-models}="selectedChildModels"
                    {get-depth-filter}="@getDepthFilter"
                    {is-open}="expanded"
  ></sub-tree-wrapper>
</div>
