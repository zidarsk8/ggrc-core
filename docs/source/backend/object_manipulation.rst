Object Manipulation
===================

Creating objects
++++++++++++++++

Audit
-----

Overview
~~~~~~~~

+---------------------+---------------------------------------------------------------------------------------------------------------------------+
| URL                 | /api/audits                                                                                                               |
+---------------------+---------------------------------------------------------------------------------------------------------------------------+
| Methods supported   | ``POST``, ``DELETE``                                                                                                      |
+---------------------+---------------------------------------------------------------------------------------------------------------------------+
| Description         | Creates an audit object. Note that if we want to add auditors, additional requests to :ref:`user-role` have to be made.   |
+---------------------+---------------------------------------------------------------------------------------------------------------------------+

Elements
~~~~~~~~

+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| Field name                       | Type                 | Description                                                                                                                 |
+==================================+======================+=============================================================================================================================+
| **Required**                     |                      |                                                                                                                             |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| title                            | str                  | Audit title                                                                                                                 |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| status                           | :ref:`audit-status`  | Status of the audit object. Note that when creating a new audit the value has to be Audit_status.PLANNED                    |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| program                          | :ref:`ggrc-object`   | Program reference                                                                                                           |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| **Optional**                     |                      |                                                                                                                             |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| description                      | str                  | Description of the audit object                                                                                             |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| slug                             | None or str          | Unique identifier for this audit (can be defined here or if empty will be created on the server and sent in the response)   |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| start_date                       | str                  | ISO-8601 formatted planned start date                                                                                       |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| end_date                         | str                  | ISO-8601 formatted planned end date                                                                                         |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| report_start_date                | str                  | ISO-8601 formatted planned report start date                                                                                |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| report_end_date                  | str                  | ISO-8601 formatted planned report start date                                                                                |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| contact                          | :ref:`ggrc-object`   | Audit captain                                                                                                               |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| audit_firm                       | :ref:`ggrc-object`   | OrgGroup reference                                                                                                          |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| custom_attribute_definitions     | list                 |                                                                                                                             |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| custom_attributes                |                      |                                                                                                                             |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+
| modified_by_id                   | str                  |                                                                                                                             |
+----------------------------------+----------------------+-----------------------------------------------------------------------------------------------------------------------------+

Examples
~~~~~~~~

-  create an audit object

   Request:

   .. code-block:: json

       {
           "audit": {
               "status": "Planned",
               "custom_attribute_definitions": [],
               "custom_attributes": {},
               "contact": {
                   "id": 1,
                   "href": "/api/people/1",
                   "type": "Person"
               },
               "title": "2016: Test Program - Audit 2",
               "program": {
                   "id": 2,
                   "href": "/api/programs/2",
                   "type": "Program"
               },
               "description": "",
               "audit_firm": {
                   "id": 1,
                   "href": "/api/org_groups/1",
                   "type": "OrgGroup"
               },
               "slug": "example code",
               "modified_by_id": "1",
               "start_date": "2016-05-02",
               "end_date": "2016-05-09",
               "report_start_date": "2016-05-02",
               "report_end_date": "2016-05-17",
           }
       }

   Response:

   .. code-block:: json

      {
          "audit": {
              "custom_attribute_values": [],
              "people": [],
              "object_type": "Assessment",
              "updated_at": "2016-05-19T14:44:25",
              "secondary_contact": null,
              "id": 2,
              "audit_firm": {
                  "href": "/api/org_groups/1",
                  "type": "OrgGroup",
                  "id": 1
              },
              "description": "",
              "object_folders": [],
              "modified_by": {
                  "href": "/api/people/1",
                  "type": "Person",
                  "id": 1
              },
              "title": "2016: Test Program - Audit 2",
              "program": {
                  "href": "/api/programs/2",
                  "type": "Program",
                  "id": 2
              },
              "object_people": [],
              "type": "Audit",
              "start_date": "2016-05-02",
              "viewLink": "/audits/2",
              "status": "Planned",
              "gdrive_evidence_folder": null,
              "related_sources": [],
              "end_date": "2016-05-09",
              "report_end_date": "2016-05-17",
              "related_destinations": [],
              "slug": "example code",
              "url": null,
              "audit_objects": [],
              "notes": null,
              "reference_url": null,
              "contact": {
                  "href": "/api/people/1",
                  "type": "Person",
                  "id": 1
              },
              "requests": [],
              "created_at": "2016-05-19T14:44:25",
              "selfLink": "/api/audits/2",
              "report_start_date": "2016-05-02"
          }
      }

Assessment
----------

Overview
~~~~~~~~

+---------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| URL                 | /api/assessments                                                                                                                                                                                                                                                                                                                                                                                                                 |
+---------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Methods supported   | ``POST``, ``DELETE``                                                                                                                                                                                                                                                                                                                                                                                                             |
+---------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Description         | Creates an assessment object. Notes: - for mapping creators, assessors and verifiers a separate request to the :ref:`relationship` has to be made - when creating assessments on the front end it's required that an object and an audit are added. The API doesn't require those fields. However if the "object" and "audit" fields are left empty, the object will be created in the DB but will not be visible on the page.   |
+---------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Elements
~~~~~~~~

+----------------------------------+-----------------------------------------+-------------------------------------+
| Field name                       | Type                                    | Description                         |
+==================================+=========================================+=====================================+
| **Required**                     |                                         |                                     |
+----------------------------------+-----------------------------------------+-------------------------------------+
| title                            | str                                     | Assessment title                    |
+----------------------------------+-----------------------------------------+-------------------------------------+
| **Optional**                     |                                         |                                     |
+----------------------------------+-----------------------------------------+-------------------------------------+
| description                      | str                                     | Assessment description              |
+----------------------------------+-----------------------------------------+-------------------------------------+
| notes                            | str                                     | Assessment notes                    |
+----------------------------------+-----------------------------------------+-------------------------------------+
| test_plan                        | str                                     | Test plan description               |
+----------------------------------+-----------------------------------------+-------------------------------------+
| start_date                       | str                                     | ISO-8601 formatted effective date   |
+----------------------------------+-----------------------------------------+-------------------------------------+
| end_date                         | str                                     | ISO-8601 formatted stop date        |
+----------------------------------+-----------------------------------------+-------------------------------------+
| reference_url                    | str                                     |                                     |
+----------------------------------+-----------------------------------------+-------------------------------------+
| url                              | str                                     | Assessment url                      |
+----------------------------------+-----------------------------------------+-------------------------------------+
| audit                            | :ref:`ggrc-object`                      | Audit for assessment                |
+----------------------------------+-----------------------------------------+-------------------------------------+
| contact                          | :ref:`ggrc-object`                      | Assessment creator                  |
+----------------------------------+-----------------------------------------+-------------------------------------+
| secondary_contact                | :ref:`ggrc-object`                      | Secondary contact                   |
+----------------------------------+-----------------------------------------+-------------------------------------+
| design                           | :ref:`assessment-conclusion`            | Conclusion design                   |
+----------------------------------+-----------------------------------------+-------------------------------------+
| operationally                    | :ref:`assessment-conclusion`            | Conclusion operation                |
+----------------------------------+-----------------------------------------+-------------------------------------+
| object                           | :ref:`ggrc-object`                      | GGRC object under assessment        |
+----------------------------------+-----------------------------------------+-------------------------------------+
| program                          | :ref:`ggrc-object`                      |                                     |
+----------------------------------+-----------------------------------------+-------------------------------------+
| recipients                       | str of comma separated :ref:`recipient` | Recipients of notifications         |
+----------------------------------+-----------------------------------------+-------------------------------------+
| Assessor                         | bool                                    | Notify assessors                    |
+----------------------------------+-----------------------------------------+-------------------------------------+
| Creator                          | bool                                    | Notify creators                     |
+----------------------------------+-----------------------------------------+-------------------------------------+
| Verifier                         | bool                                    | Notify verifiers                    |
+----------------------------------+-----------------------------------------+-------------------------------------+
| custom_attribute_definitions     | list                                    |                                     |
+----------------------------------+-----------------------------------------+-------------------------------------+
| custom_attributes                |                                         |                                     |
+----------------------------------+-----------------------------------------+-------------------------------------+
| owners                           | list                                    |                                     |
+----------------------------------+-----------------------------------------+-------------------------------------+
| send_by_default                  | bool                                    |                                     |
+----------------------------------+-----------------------------------------+-------------------------------------+
| status                           | str                                     |                                     |
+----------------------------------+-----------------------------------------+-------------------------------------+
| slug                             | str                                     | Unique identifier for Assessments   |
+----------------------------------+-----------------------------------------+-------------------------------------+
| validate_creator                 | bool                                    |                                     |
+----------------------------------+-----------------------------------------+-------------------------------------+
| validate_assessor                | bool                                    |                                     |
+----------------------------------+-----------------------------------------+-------------------------------------+

Examples
~~~~~~~~

-  create a new assessment

   Request:

   .. code-block:: json

       {
           "assessment": {
               "status": "Not Started",
               "custom_attribute_definitions": [],
               "owners": [],
               "custom_attributes": {},
               "contact": {
                   "id": 1,
                   "href": "/api/people/1",
                   "type": "Person"
               },
               "validate_creator": true,
               "validate_assessor": true,
               "title": "Example title",
               "object": {
                   "id": 1,
                   "href": "/api/people/1",
                   "type": "Person"
               },
               "audit": {
                   "id": 1,
                   "href": "/api/audits/1",
                   "type": "Audit"
               },
               "description": "Example description",
               "send_by_default": true,
               "Creator": true,
               "Assessor": true,
               "Verifier": true,
               "test_plan": "Example plan",
               "secondary_contact": {
                   "id": 1,
                   "href": "/api/people/1",
                   "type": "Person"
               },
               "notes": "Example notes",
               "url": "assessmenturl.com",
               "reference_url": "referenceurl.com",
               "slug": "Example code2",
               "design": "Ineffective",
               "operationally": "Needs improvement",
               "start_date": "2016-05-08",
               "end_date": "2016-05-18",
               "recipients": "Creator,Assessor,Verifier",
               "program": {
                   "id": 1,
                   "href": "/api/programs/1",
                   "type": "Program"
               }
           }
       }

   Response:

   .. code-block:: json

      {
          "assessment": {
              "custom_attribute_values": [],
              "people": [],
              "verified_date": null,
              "task_group_objects": [],
              "design": "Ineffective",
              "secondary_contact": {
                  "href": "/api/people/1",
                  "type": "Person",
                  "id": 1
              },
              "id": 2,
              "description": "Example description",
              "finished_date": null,
              "documents": [],
              "verified": false,
              "recipients": "Creator,Assessor,Verifier",
              "title": "Example title",
              "contact": {
                  "href": "/api/people/1",
                  "type": "Person",
                  "id": 1
              },
              "object_people": [],
              "type": "Assessment",
              "start_date": "2016-05-08",
              "viewLink": "/assessments/2",
              "status": "Not Started",
              "related_sources": [],
              "end_date": "2016-05-18",
              "workflow_state": null,
              "os_state": "Draft",
              "object": {},
              "updated_at": "2016-05-20T09:01:26",
              "object_documents": [],
              "modified_by": {
                  "href": "/api/people/1",
                  "type": "Person",
                  "id": 1
              },
              "related_destinations": [
                  {
                      "href": "/api/relationships/None",
                      "type": "Relationship",
                      "id": null
                  },
                  {
                      "href": "/api/relationships/None",
                      "type": "Relationship",
                      "id": null
                  },
                  {
                      "href": "/api/relationships/None",
                      "type": "Relationship",
                      "id": null
                  }
              ],
              "slug": "Example code2",
              "audit": {},
              "owners": [],
              "send_by_default": true,
              "url": "assessmenturl.com",
              "task_groups": [],
              "notes": "Example notes",
              "reference_url": "referenceurl.com",
              "object_owners": [],
              "test_plan": "Example plan",
              "operationally": "Needs improvement",
              "created_at": "2016-05-20T09:01:26",
              "selfLink": "/api/assessments/2"
          }
      }

Object owner
------------

Overview
~~~~~~~~

+---------------------+-----------------------------------+
| URL                 | /api/object_owners                |
+---------------------+-----------------------------------+
| Methods supported   | ``POST``, ``DELETE``              |
+---------------------+-----------------------------------+
| Description         | Creates an object owner object.   |
+---------------------+-----------------------------------+

Elements
~~~~~~~~

+----------------+--------+---------------+
| Field name     | Type   | Description   |
+================+========+===============+
| **Required**   |        |               |
+----------------+--------+---------------+

Program
-------

Overview
~~~~~~~~

+---------------------+-----------------------------+
| URL                 | /api/programs               |
+---------------------+-----------------------------+
| Methods supported   | ``POST``, ``DELETE``        |
+---------------------+-----------------------------+
| Description         | Creates a program object.   |
+---------------------+-----------------------------+

Elements
~~~~~~~~

+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| Field name                       | Type                         | Description                                                                       |
+==================================+==============================+===================================================================================+
| **Required**                     |                              |                                                                                   |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| title                            | str                          | Program unique title                                                              |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| **Optional**                     |                              |                                                                                   |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| description                      | str                          | Program description                                                               |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| notes                            | str                          | Program notes                                                                     |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| url                              | str                          | Program url                                                                       |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| reference_url_url                | str                          | Reference url                                                                     |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| kind                             | :ref:`program-status`        |                                                                                   |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| start_date                       | str                          | Effective date in MDY format e.g. "05/31/2016"                                    |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| end_date                         | str                          | Stop date in MDY format e.g. "05/31/2016"                                         |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| contact                          | :ref:`ggrc-object`           | Primary contact                                                                   |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| secondary_contact                | None or :ref:`ggrc-object`   | Secondary contact.                                                                |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| custom_attributes                |                              |                                                                                   |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| custom_attribute_definitions     | list                         |                                                                                   |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| status                           | str                          |                                                                                   |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+
| slug                             | str                          | Unique string identifier for this program                                         |
+----------------------------------+------------------------------+-----------------------------------------------------------------------------------+

Examples
~~~~~~~~

-  create a program

   Request:

   .. code-block:: json

       {
          "program":{
             "custom_attribute_definitions":[],
             "custom_attributes":{},
             "contact":{
                "id":3,
                "href":"/api/people/3",
                "type":"Person"
             },
             "kind":"Directive",
             "title":"Test title",
             "description":"Some description",
             "secondary_contact":{
                "id":4,
                "href":"/api/people/4",
                "type":"Person"
             },
             "notes":"Here are my notes",
             "url":"programurl.com",
             "reference_url":"referenceurl.com",
             "slug":"SOME CODE",
             "start_date":"05/01/2016",
             "end_date":"05/31/2016",
             "status":"Draft",
          }
       }

   Response:

   .. code-block:: json

      {
          "program": {
              "custom_attribute_values": [],
              "people": [],
              "updated_at": "2016-05-19T12:09:15",
              "task_group_objects": [],
              "audits": [],
              "id": 10,
              "description": "Some description",
              "object_folders": [],
              "documents": [],
              "modified_by": {
                  "href": "/api/people/1",
                  "type": "Person",
                  "id": 1
              },
              "title": "Test title",
              "secondary_contact": {
                  "href": "/api/people/4",
                  "type": "Person",
                  "id": 4
              },
              "risk_assessments": [],
              "object_people": [],
              "type": "Program",
              "start_date": "2016-05-01",
              "viewLink": "/programs/10",
              "status": "Draft",
              "related_sources": [],
              "end_date": "2016-05-31",
              "workflow_state": null,
              "os_state": "Modified",
              "risk_objects": [],
              "owners": [],
              "object_documents": [],
              "related_destinations": [],
              "slug": "SOME CODE",
              "kind": "Directive",
              "url": "programurl.com",
              "task_groups": [],
              "notes": "Here are my notes",
              "reference_url": "referenceurl.com",
              "object_owners": [],
              "contact": {
                  "href": "/api/people/3",
                  "type": "Person",
                  "id": 3
              },
              "risks": [],
              "created_at": "2016-05-19T12:09:14",
              "selfLink": "/api/programs/10"
          }
      }

Request
-------

Overview
~~~~~~~~

+---------------------+-----------------------------+
| URL                 | /api/requests               |
+---------------------+-----------------------------+
| Methods supported   | ``POST``, ``DELETE``        |
+---------------------+-----------------------------+
| Description         | Creates a program object.   |
+---------------------+-----------------------------+

Elements
~~~~~~~~

+----------------------------------+----------------------+---------------------------------------+
| Field name                       | Type                 | Description                           |
+==================================+======================+=======================================+
| **Required**                     |                      |                                       |
+----------------------------------+----------------------+---------------------------------------+
| title                            | str                  | Request title                         |
+----------------------------------+----------------------+---------------------------------------+
| audit                            | :ref:`ggrc-object`   | Audit mapped to this request object   |
+----------------------------------+----------------------+---------------------------------------+
| start_date                       | str                  | ISO-8601 formatted effective date     |
+----------------------------------+----------------------+---------------------------------------+
| end_date                         | str                  | ISO-8601 formatted stop date          |
+----------------------------------+----------------------+---------------------------------------+
| **Optional**                     |                      |                                       |
+----------------------------------+----------------------+---------------------------------------+
| status                           | str                  |                                       |
+----------------------------------+----------------------+---------------------------------------+
| custom_attribute_definitions     | list                 |                                       |
+----------------------------------+----------------------+---------------------------------------+
| custom_attributes                |                      |                                       |
+----------------------------------+----------------------+---------------------------------------+
| validate_requester               | bool                 |                                       |
+----------------------------------+----------------------+---------------------------------------+
| validate_assignee                | bool                 |                                       |
+----------------------------------+----------------------+---------------------------------------+
| description                      | str                  | Request description                   |
+----------------------------------+----------------------+---------------------------------------+
| request_type                     | :ref:`request`       |                                       |
+----------------------------------+----------------------+---------------------------------------+
| test                             | str                  | Test message                          |
+----------------------------------+----------------------+---------------------------------------+
| notes                            | str                  | Notes for the request                 |
+----------------------------------+----------------------+---------------------------------------+
| slug                             | str                  | Unique identifier for this request    |
+----------------------------------+----------------------+---------------------------------------+

Examples
~~~~~~~~

-  create a new request object

   Request:

   .. code-block:: json

       {
           "request": {
               "status": "Not Started",
               "start_date": "2016-05-20",
               "end_date": "2016-05-27",
               "custom_attribute_definitions": [],
               "custom_attributes": {},
               "validate_requester": true,
               "validate_assignee": true,
               "title": "Example title",
               "audit": {
                   "id": 1,
                   "href": "/api/audits/1",
                   "type": "Audit"
               },
               "description": "Example description",
               "request_type": "documentation",
               "test": "Example test message",
               "notes": "Example notes",
               "slug": "test code",
           }
       }

   Response:

   .. code-block:: json

      {
          "request": {
              "custom_attribute_values": [],
              "people": [],
              "updated_at": "2016-05-20T10:14:42",
              "task_group_objects": [],
              "id": 1,
              "related_sources": [
                  {
                      "href": "/api/relationships/14",
                      "type": "Relationship",
                      "id": 14
                  }
              ],
              "finished_date": null,
              "object_folders": [],
              "documents": [],
              "modified_by": {
                  "href": "/api/people/1",
                  "type": "Person",
                  "id": 1
              },
              "recipients": null,
              "title": "Example title",
              "verified": false,
              "requestor": null,
              "object_people": [],
              "test": "Example test message",
              "type": "Request",
              "start_date": "2016-05-20",
              "viewLink": "/requests/1",
              "status": "Not Started",
              "verified_date": null,
              "description": "Example description",
              "end_date": "2016-05-27",
              "workflow_state": null,
              "object_documents": [],
              "gdrive_upload_path": null,
              "related_destinations": [],
              "slug": "test code",
              "audit": {
                  "href": "/api/audits/1",
                  "type": "Audit",
                  "id": 1
              },
              "send_by_default": null,
              "task_groups": [],
              "notes": "Example notes",
              "request_type": "documentation",
              "created_at": "2016-05-20T10:14:42",
              "selfLink": "/api/requests/1"
          }
      }

Workflow
~~~~~~~~

Overview
~~~~~~~~

+---------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
| URL                 | /api/workflows                                                                                                                                     |
+---------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
| Methods supported   | ``POST``, ``DELETE``                                                                                                                               |
+---------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+
| Description         | Creates a workflow object. Note that if you want to connect task group to this object, a separate request to :ref:`task-group` needs to be made.   |
+---------------------+----------------------------------------------------------------------------------------------------------------------------------------------------+

Elements
~~~~~~~~

+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| Field name                       | Type                        | Description                                                                      |
+==================================+=============================+==================================================================================+
| **Required**                     |                             |                                                                                  |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| title                            | str                         | Workflow title                                                                   |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| **Optional**                     |                             |                                                                                  |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| description                      | str                         | Workflow description                                                             |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| frequency_options                | list                        |                                                                                  |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| frequency                        | :ref:`workflow-frequency`   | Note that if this field isn't sent, :ref:`workflow-frequency`.ONE_TIME is used   |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| custom_attribute_definitions     |                             |                                                                                  |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| custom_attributes                |                             |                                                                                  |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| notify_on_change                 | bool                        | Enable real time email updates                                                   |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| task_group_title                 | str                         |                                                                                  |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| notify_custom_message            | str                         | Custom email message                                                             |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| slug                             | str                         | Unique identifier for this workflow                                              |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+
| owners                           |                             |                                                                                  |
+----------------------------------+-----------------------------+----------------------------------------------------------------------------------+

Examples
~~~~~~~~

-  create a new workflow

   Request:

   .. code-block:: json

       {
         "workflow":{
            "frequency_options":[
               {
                  "title":"One time",
                  "value":"one_time"
               },
               {
                  "title":"Weekly",
                  "value":"weekly"
               },
               {
                  "title":"Monthly",
                  "value":"monthly"
               },
               {
                  "title":"Quarterly",
                  "value":"quarterly"
               },
               {
                  "title":"Annually",
                  "value":"annually"
               }
            ],
            "frequency":"one_time",
            "custom_attribute_definitions":[],
            "custom_attributes":{},
            "title":"Test title",
            "description":"Some description.&nbsp;<br><b>This part is bold.</b>",
            "notify_on_change":false,
            "task_group_title":"Task Group 1",
            "notify_custom_message":"Example email message.",
            "slug":"Some unique value",
            "owners":null,
         }
          }

   Response:

   .. code-block:: json

       {
           "workflow":{
              "status":"Draft",
              "notify_custom_message":"Example email message.",
              "custom_attribute_values":[

              ],
              "notify_on_change":false,
              "description":"Some description.\u00a0<br><b>This part is bold.</b>",
              "end_date":null,
              "people":[
                 {
                    "href":"/api/people/1",
                    "type":"Person",
                    "id":1
                 }
              ],
              "non_adjusted_next_cycle_start_date":null,
              "updated_at":"2016-05-19T12:57:02",
              "frequency":"one_time",
              "recurrences":false,
              "id":1,
              "object_folders":[

              ],
              "kind":null,
              "modified_by":{
                 "href":"/api/people/1",
                 "type":"Person",
                 "id":1
              },
              "next_cycle_start_date":null,
              "object_approval":false,
              "title":"Test title",
              "task_groups":[

              ],
              "created_at":"2016-05-19T12:57:02",
              "workflow_state":null,
              "slug":"Some unique value",
              "workflow_people":[
                 {
                    "href":"/api/workflow_people/1",
                    "type":"WorkflowPerson",
                    "id":1
                 }
              ],
              "cycles":[

              ],
              "type":"Workflow",
              "start_date":null,
              "selfLink":"/api/workflows/1",
              "viewLink":"/workflows/1"
           }
        }


.. _task-group:

Task Group
~~~~~~~~~~

Overview
~~~~~~~~

+---------------------+-------------------------------+
| URL                 | /api/task_groups              |
+---------------------+-------------------------------+
| Methods supported   | ``POST``, ``DELETE``          |
+---------------------+-------------------------------+
| Description         | Creates a task group object   |
+---------------------+-------------------------------+

Elements
~~~~~~~~

+----------------+----------------------+-------------------------------------------------+
| Field name     | Type                 | Description                                     |
+================+======================+=================================================+
| **Required**   |                      |                                                 |
+----------------+----------------------+-------------------------------------------------+
| title          | str                  | Task group title                                |
+----------------+----------------------+-------------------------------------------------+
| workflow       | :ref:`ggrc-object`   | Workgroup object reference                      |
+----------------+----------------------+-------------------------------------------------+
| **Optional**   |                      |                                                 |
+----------------+----------------------+-------------------------------------------------+
| contact        | :ref:`ggrc-object`   |                                                 |
+----------------+----------------------+-------------------------------------------------+

Examples
~~~~~~~~

-  map a task group to a workflow

   Request:

   .. code-block:: json

      {
          "task_group": {
              "title": "Task Group 1",
              "workflow": {
                  "id": 1,
                  "href": "/api/workflows/1",
                  "type": "Workflow"
              },
              "contact": {
                  "id": 1,
                  "href": "/api/people/1",
                  "type": "Person"
              },
          }
      }

   Response:

   .. code-block:: json

       {
           "task_group": {
               "description": null,
               "end_date": null,
               "workflow": {
                   "href": "/api/workflows/2",
                   "type": "Workflow",
                   "id": 2
               },
               "updated_at": "2016-05-19T14:37:23",
               "task_group_objects": [],
               "objects": [],
               "modified_by": {
                   "href": "/api/people/1",
                   "type": "Person",
                   "id": 1
               },
               "secondary_contact": null,
               "id": 2,
               "slug": "TASKGROUP-2",
               "task_group_tasks": [],
               "lock_task_order": null,
               "title": "Task Group 1",
               "created_at": "2016-05-19T14:37:23",
               "sort_index": "",
               "contact": {
                   "href": "/api/people/1",
                   "type": "Person",
                   "id": 1
               },
               "type": "TaskGroup",
               "start_date": null,
               "selfLink": "/api/task_groups/2"
           }
       }


.. _user-role:

User Role
---------

Overview
~~~~~~~~

+-------------------+-----------------------------------------------------------------------+
| URL               | /api/user_roles                                                       |
+-------------------+-----------------------------------------------------------------------+
| Methods supported | ``POST``                                                              |
+-------------------+-----------------------------------------------------------------------+
| Description       | Assigns a role to an user. Note that instead of making a request to   |
|                   | :ref:`relationship` with source=[some_role_object] and                |
|                   | destination=[some_user_object], this endpoint is preferred for        |
|                   | assigning roles to users.                                             |
+-------------------+-----------------------------------------------------------------------+


Element
~~~~~~~

+--------------+--------------------+-------------------------------------+
| Field name   | Type               | Description                         |
+==============+====================+=====================================+
| **Required** |                    |                                     |
+--------------+--------------------+-------------------------------------+
| person       | :ref:`ggrc-object` | Person we want to set the role for. |
+--------------+--------------------+-------------------------------------+
| role         | :ref:`ggrc-object` | Role reference.                     |
+--------------+--------------------+-------------------------------------+
| **Optional** |                    |                                     |
+--------------+--------------------+-------------------------------------+
| role_name    | :ref:`role`        | Person role                         |
+--------------+--------------------+-------------------------------------+


Examples
~~~~~~~~

*   add an auditor to an audit object

    Request:

    .. code-block:: json

        {
            "user_role": {
                "person": {
                    "id": 1,
                    "href": "/api/people/1",
                    "type": "Person"
                },
                "role_name": "Auditor",
                "role": {
                    "id": 14,
                    "href": "/api/roles/14",
                    "type": "Role"
                }
            }
        }

    Response:

    .. code-block:: json

        {
            "user_role": {
                "modified_by": {
                    "href": "/api/people/1",
                    "type": "Person",
                    "id": 1
                },
                "created_at": "2016-05-19T14:50:24",
                "updated_at": "2016-05-19T14:50:24",
                "person": {
                    "href": "/api/people/1",
                    "type": "Person",
                    "id": 1
                },
                "role": {
                    "href": "/api/roles/14",
                    "type": "Role",
                    "id": 14
                },
                "type": "UserRole",
                "id": 7,
                "selfLink": "/api/user_roles/7"
            }
        }


Creating relationships between objects
++++++++++++++++++++++++++++++++++++++

.. _relationship:

Relationship
------------

Overview
~~~~~~~~

+---------------------+---------------------------------------------------+
| URL                 | /api/relationships                                |
+---------------------+---------------------------------------------------+
| Methods supported   | ``POST``                                          |
+---------------------+---------------------------------------------------+
| Description         | Creates a relationship between multiple object.   |
+---------------------+---------------------------------------------------+

Elements
~~~~~~~~

+----------------+-----------------------+-------------------------------------+
| Field name     | Type                  | Description                         |
+================+=======================+=====================================+
| **Required**   |                       |                                     |
+----------------+-----------------------+-------------------------------------+
| source         | :ref:`ggrc-object`    | The object we want to connect.      |
+----------------+-----------------------+-------------------------------------+
| destination    | :ref:`ggrc-object`    | The object we want to connect to.   |
+----------------+-----------------------+-------------------------------------+
| **Optional**   |                       |                                     |
+----------------+-----------------------+-------------------------------------+
| attrs          | :ref:`ggrc-attribute` | Additional attribute options.       |
+----------------+-----------------------+-------------------------------------+

Examples
~~~~~~~~

-  map a person with id=1 to assessments with id=3 as assessor and
   verifier

   Request:

   .. code-block:: json

        {
            "relationship": {
                "source": {
                    "id": 1,
                    "href": "/api/people/1",
                    "type": "Person"
                },
                "destination": {
                    "id": 3,
                    "href": "/api/assessments/3",
                    "type": "Assessment"
                },
                "attrs": {
                    "AssigneeType": "Assessor,Verifier"
                }
            }
        }

   Response:

   .. code-block:: json

        {
            "relationship": {
                "status": "Draft",
                "modified_by": {
                    "href": "/api/people/1",
                    "type": "Person",
                    "id": 1
                },
                "created_at": "2016-05-20T09:19:34",
                "destination": {
                    "href": "/api/assessments/3",
                    "type": "Assessment",
                    "id": 3
                },
                "updated_at": "2016-05-20T09:19:34",
                "source": {
                    "href": "/api/people/3",
                    "type": "Person",
                    "id": 3
                },
                "attrs": {
                    "AssigneeType": "Verifier,Assessor"
                },
                "type": "Relationship",
                "id": 12,
                "selfLink": "/api/relationships/12"
            }
        }


Objects
+++++++

.. _ggrc-object:

GGRC object
-----------

+------------+------+---------------------------------------+
| Field name | Type | Description                           |
+============+======+=======================================+
| id         | int  | object id                             |
+------------+------+---------------------------------------+
| href       | str  | uri reference e.g. "/api/programs/12" |
+------------+------+---------------------------------------+
| type       | str  | :ref:`ggrc-object-type`               |
+------------+------+---------------------------------------+


.. _ggrc-attribute:

GGRC attribute
--------------

+--------------+------+--------------------------------------------------+
| Field name   | Type | Description                                      |
+==============+======+==================================================+
| AssigneeType | str  | comma separated sequence of :ref:`assignee-type` |
+--------------+------+--------------------------------------------------+



Types
+++++

.. _audit-status:

Audit status
------------

* Planned
* In Progress
* Manager Review
* Ready for External Review
* Completed


.. _assignee-type:

Assignee Type
~~~~~~~~~~~~~

* Assessor
* Verifier


.. _assessment-conclusion:

Assessment conclusion
~~~~~~~~~~~~~~~~~~~~~

* Effective
* Ineffective
* Needs improvement
* Not Applicable


.. _ggrc-object-type:

GGRC object Type
~~~~~~~~~~~~~~~~

* Audit
* AccessGroup
* Assessment
* Contract
* Control
* CycleTaskGroupObjectTask
* DataAsset
* Facility
* Issue
* Market
* Objective
* OrgGroup
* Person
* Policy
* Process
* Product
* Program
* Project
* Regulation
* Relationship
* Request
* Request
* Risk
* Section
* Standard
* System
* Threat
* TaskGroup
* Vendor
* Workflow
* WorkflowPerson


.. _recipient:

Recipient
~~~~~~~~~

* Creator
* Assessor
* Verifier


.. _role:

Role
~~~~

* Auditor
* AuditorProgramReader
* AuditorReader
* ObjectEditor
* ProgramBasicReader
* ProgramReader
* ProgramCreator
* ProgramOwner
* ProgramEditor
* ProgramAuditOwner
* ProgramAuditEditor
* ProgramAuditReader
* Reader


.. _program-status:

Program status
~~~~~~~~~~~~~~

* Draft
* Final
* Effective
* Ineffective
* Launched
* Not Launched
* In Scope
* Not in Scope
* Deprecated


.. _request:

Request
~~~~~~~

* documentation
* interview


.. _workflow-frequency:

Workflow frequency
~~~~~~~~~~~~~~~~~~

* one_time
* weekly
* monthly
* quarterly
* annually
